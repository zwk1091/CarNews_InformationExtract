标题：车辆近距离蓝牙授权分享钥匙的设计
内容：通过蓝牙近距离授权的方式，进行钥匙的互相分享，对解决此漏洞有很好的改善效果，且对车辆安全具有显著意义。手机等移动终端作为汽车钥匙是汽车钥匙发展的智能化形态，车主更加关注它的安全性和便利性。目前现有的车辆分享钥匙为通过移动通信，例如短信码，或者移动蜂窝网络、4G等方式，实现车辆与智能钥匙之间的信息传送，从而进行钥匙的分享。而实际应用场景中，存在运营商通信中断或者无网络信号时，例如在山区等信号不发达的偏僻地区。此时，由于汽车无法通信，导致无法分享，此功能失效。而相比于如上通信方式，蓝牙具备低功耗、无通信费用且不依赖于任何通信方式的稳定性等特质。基于以上分析，本文提出了一种通过在车载端增设蓝牙模块，使其与手机等移动终端设备的蓝牙模块相连接，进行秘钥分享的方法，解决了无网络通信信号或者信号差的情况下，依然可以正常进行车辆分享的问题，提高了车辆使用的便利性。经过验证，可以达到预期的效果。问题描述与分析1.问题背景虚拟手机钥匙，是目前各大主机厂青睐的钥匙形式。共享汽车一夜之间火爆中国，其中很大的亮点是利用手机作为车钥匙。车主只需要在手机端下载一款APP，通过设置时间、地域和车辆使用的权限等即可成功将车辆分享给他人使用。2.问题描述（1）现象与危害通过对目前市场上公开的手机钥匙通信及共享方式进行分析得出：绝大数分享车辆需要使用网络进行秘钥的传输和生效，这将导致一些特殊的情况：例如山区信号不好、交通工具经过山洞时或到郊区旅游等生活中经常出现的场景下，钥匙失效或者无法分享车辆的情况。（2）设计目标保证车主在无网络信号的情况下，依然可以正常使用和分享汽车。3.问题分析不能自主地对钥匙进行认证，需要借助于后台服务器。如A公司的分享方案，第1便携型电子设备、第2便携性电子设备和车辆钥匙登陆部三者之间的通信过于依赖后台服务器，当第1便携设备发起分享车辆信息后，信息被传送给后台服务器，进行信息的审核和处理，然后形成新的秘钥发送给第2便携设备。此分享过程会导致无网络信号时，由于后台服务器接收不了或者发送不了秘钥信息，将会导致新密钥无法生效，分享失败。B公司的手机虚拟钥匙授权范围太小。仅仅授权车门的解闭锁权限，而车辆起动和行李箱的开启权限没有，此方案依然无法完全脱离实体钥匙，钥匙成本很高，便利性降低。手机需要安装硬件，受制于手机制造商。如，C公司，需要在手机中安装特定的蓝牙芯片才能和车辆建立通信，需要对手机进行改装或者在手机制造的过程中添加相应的硬件，对于用户和汽车厂商来说十分不便。4.问题确定1）在无网络信号覆盖的情况下，汽车钥匙依然生效，分享成功。当车辆或者手机处于无网络信号覆盖的区域，手机钥匙依然可以与车机进行通信，通过钥匙认证，使用车辆；同时当车主的手机处于无网络信号覆盖的情况下，依然可以对其他车主进行分享，提高分享的便利性。2）将汽车钥匙的全部功能释放，彻底脱离实体钥匙。车主使用该手机钥匙，可以开关车门、起停车辆、开启行李箱、寻车等实体钥匙所有的功能。保证无实体钥匙存在时，车主可以正常用车。3）去掉分享过程中后台服务器的参与，在近距离时，使分享过程更加简单。4）利用移动设备现有的蓝牙模块，只需要更改软件策略即可实现，不需要增加额外的成本并避免了一些不可控的风险。解决方案利用蓝牙功耗低、费用低、手机装配率高且匹配速度较快等优势，在车辆PEPS系统模块中增设蓝牙模块，该模块可以与移动终端设备手机中的蓝牙模块互相连接并通信。图1为系统结构图，具体阐述车辆近距离蓝牙通信的方式进行车辆共享的过程。本系统由移动设备I、移动设备Ⅱ和车辆PEPSECU三部分组成，这三部分均包含蓝牙模块，三者之间通过蓝牙进行信息的传递。当借车人需要用车时，可与车主进行线下沟通需求，由车主主动发起请求。具体过程如下：移动设备I在和车辆PEPSECU系统进行蓝牙连接的情况下主动发起分享请求，车辆收到该请求信息并进行解析，处理并生成相应的代码发送给移动设备I。移动设备I通过蓝牙通信的方式，触发APP中相关操作将代码发送至移动设备Ⅱ。移动设备Ⅱ获得钥匙代码后，在到达车辆附近的一定区域后，与车辆建立蓝牙通信连接，将代码发送给车辆，车辆验证通过后反馈给移动设备Ⅱ相应的授权信息，使其能进行相关操作。其中，移动设备I给车辆PEPSECU发送的分享请求信息中包括：本设备的手机号、mac地址、手机串号、请求信息、被分享者的手机号、分享功能、分享时限及分享地域等信息。车主在发起请求时，需要在手机APP端的应用程序中进行相关信息的设置或填写，并将该信息加密封装，通过触发APP应用程序中的相关按钮，进行消息的发送。车辆PEPSECU系统通过蓝牙模块接收到该信息后，首先对该信息解密，并解析出请求信息的内容，若解读为“可分享”，则将剩余的信息进行解读并加密封装，同时将车辆秘钥数据库中的一个合法钥匙信息加密发送给移动设备I，移动设备I收到反馈信息时，确认，并将其通过蓝牙通信传送给移动设备Ⅱ，此时移动设备Ⅱ，因为拥有了车辆的合法秘钥信息，可以作为一把有特定权限的车辆钥匙。于是被分享者可以携带移动设备Ⅱ，进入车辆蓝牙连接的有效区域，与车辆PEPSECU模块进行蓝牙连接，成功后即可将秘钥信息传输给车辆，车辆对秘钥的合法性进行验证，验证通过后，被分享者即可通过拉车门的方式进入车辆、起动车辆等。使用车辆的权限与车主设定的功能完全一致。移动设备Ⅱ的合法性验证过程如图2所示。移动设备I在与车辆通过蓝牙连接后，向车辆发送分享的请求。车辆判断该请求是否合理合法，比如该设备是否具有给他人分享的权限、车辆所能进行的分享代码数是否达到上限等，以上条件都满足的情况下，会将移动设备I传输的请求信息解析并储存，同时反馈相应秘钥信息给移动设备I，不合理的情况下分享请求被拒绝；移动设备I将此秘钥信息分享给移动设备Ⅱ；移动设备Ⅱ接收到该分享信息后，请求与车辆的蓝牙互配连接，首次连接需要手工匹配，配对成功后，会将该配对信息存入车辆的蓝牙合法列表中，第二次及以后的连接为双方感应到对方后自动匹配，即当被分享者进入车辆蓝牙有效区域后，两者的蓝牙模块自动连接，除非当被分享者的秘钥时限达到时，会将该蓝牙信息自动剔除。下次需要被分享时，继续手工连接一下即可。移动设备Ⅱ与车辆连接成功后，会将移动设备I传送给它的秘钥信息发送给车辆PEPS控制单元，并发出秘钥认证的请求，车辆收到该信息后，首先将该信息解析，识别出秘钥信息是否与车辆的秘钥数据库中的信息一致，如果一致则认为秘钥合法；然后判断当前时间是否在分享的时限区域内，如果在此区域，则认为时间合法，否则秘钥失效，流程停止；最后判断当前车辆位置是否符合分享地域，如果符合则验证通过，不符合则秘钥失效，流程停止；如上步骤已经将移动设备Ⅱ的秘钥信息进行了合法认证，如全部符合，则解析传送信息中包含的功能权限信息，并将其作为车辆功能的先决条件。例如：被分享者可能为快递人员，车主只分享了行李箱使用的权限，则该被分享者手持手机，只能对车辆的行李箱进行开启、关闭的操作，其余的车辆功能不具备。结论目前虚拟车钥匙与共享汽车快速发展，更需要我们保障车主的用车便利性，车主不需要携带实体钥匙即可使用车辆，车主亦可以在偏僻地段、无网络地段进行车辆的互享。本文中提出：在无移动网络信号和通信信号不稳定的情况下，使用近距离蓝牙授权的方式进行车辆互享，通过车主主动发起请求，更加可靠地保证了用车需求的真实性；蓝牙的低功耗特性使得这种方式并不会导致车辆馈电，成本低、装配性高，使得这种方式能够更好地应用。通过以上论证，得出：此方案在保留原系统优势的基础上，已消除原系统中的不足，并没有引入新的缺陷，满足最终理想解的特点。此方案直接将通信方式改为蓝牙的方式，移动设备和车辆中自带蓝牙模块，不需要再增加额外的通信设备、减少了额外的通信成本，投入使用具备一定的实用性和可操作性。以往的研究均为靠短信码、移动蜂窝网络通信进行秘钥的传输，此种策略在网络连接顺畅、移动通信有信号时具有一定的优势，但是当外部通信环境不佳时，分享车辆的过程会受到限制，而使用各自拥有的蓝牙模块进行通信，刚好弥补了这一缺陷；蓝牙在近距离通信时，稳定性比较好，当前技术比较成熟，应用于批量生产亦具有明显的可操作性。此方案可以更加巧妙地解决网络信号不佳时的应用场景，很大程度上给车主带来用车的便利性，使车辆的使用价值更大化。此方案中，使用了蓝牙通信进行秘钥的传输，从而进行车辆分享，但是蓝牙的传输距离较短，且此分享过程需要与车辆进行秘钥的互动，所以在使用上，需要双方到达车辆100m以内的位置方可进行，由于距离近，双方可见，一定程度上使分享车辆更加安全，但同时也损失了一部分的便利性。后期可通过添加蓝牙信标等范围更大的传输方法继续对该方案进行研究和实验，进一步补充，方可制定出更完美的方案。
