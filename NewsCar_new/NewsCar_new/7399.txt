标题：基于单片机的汽车制冷系统维护自动化设备
内容：制冷系统已成为的现代汽车重要配置，制冷系统内的冷媒量和冷媒纯度都是影响制冷效果的关键因素，需要按期进行系统检测和冷媒更换。冷媒的更换过程分为冷媒回收、抽真空、注冷冻油和冷媒加注四个步骤。目前我国的汽车制冷系统的维修和维护的手段，大多仍是人工操作，其工作过程繁杂，效率低下，常因操作不当导致系统损伤。作者完成的汽车制冷系统维护的自动化设备研制，有效地提高了维修效率和维护质量，实现了汽车制冷系统冷媒更换的全自动操作，使用简便，界面友好。全自动冷媒加注控制系统采用16位单片机MSP430F149为核心控制器，采用了ATERA公司新型CPLD器件EPF10K10A，并实现了外存数据加密，整机功能完备、可靠性高。2系统结构及控制流程全自动冷媒加注系统结构主要由嵌入式控制系统、电子秤、真空泵、压缩机、多个状态检测传感器、执行开关和电磁阀等组成。如图1所示。图1冷媒加注系统结构图冷媒加注系统自动控制的工作流程有：车辆信息输入、加注信息查询、冷媒识别和回收、抽真空、加冷冻油、加冷媒及结果打印八项内容，如图2所示。(1)车辆信息输入在将被检修车辆的冷媒管道同冷媒加注系统正确连接之后，操作员通过操作面板键盘输入车辆的生产厂家、车辆型号和年月信息等参数。(2)加注信息查询控制系统根据输入的车辆信息，在车辆加注信息数据库中查找对应该车的冷媒类型、冷冻油加注量、冷媒加注量及其它控制参数。(3)冷媒识别发控制信号启动冷媒分析仪，冷媒分析仪提取车辆冷媒试样进行类型分析，识别结果提交控制系统。要求冷媒加注系统储存罐内与被加注车辆的冷媒类型相同，否则系统给出报警提示，调换与之相同类型的冷媒储罐后，继续下一步工作。(4)冷媒回收控制相应的执行机构，依靠车辆冷媒管路内自身的压力进行冷媒回收，回收的冷媒经净化处理后，导入冷媒储罐。(5)抽真空回收压力平衡后，控制打开真空泵，抽取车辆冷媒管路中残余的冷媒气体，直至接近零压。关闭真空泵，真空传感器监测车辆冷媒储存室压力。以确定的时间内压力值得变化，检测冷媒管路是否存在泄漏。若无泄漏，进入下一步工作，否则需先对冷媒管路进行维修，确保冷媒管路密封良好。(6)加冷冻油按照控制流程，向车辆制冷系统加入对应该车的定量冷冻油。(7)冷媒加注向车辆加入相应量的同类型冷媒。(8)打印加注结果系统配置的微型打印机打印本次"加注工作"的有关项目和参数，提交用户和存档。至此，完成冷媒加注的全过程。依据上述的系统结构和控制流程，全自动汽车冷媒加注控制系统设计重点研究和解决了四个问题：第一，系统工作稳定可靠和较强的抗干扰能力；第二，人机接口设计友好、直观和操作方便；第三，实现嵌入式车辆冷媒加注信息数据库系统；第四，研制高精度电子秤，保证冷媒重量的精确计量，实现冷媒加注量的准确控制。3硬件系统设计冷媒加注系统属于"汽保"设备，工作环境比较恶劣，电磁干扰较大。本着稳定可靠、线路简单，同时要求功能完备、技术新颖的设计目标，全自动汽车冷媒加注控制系统的硬件系统结构如图3所示。主要组成部件有：MSP430F149单片机、复杂可编程逻辑器件(CPLD)、压力传感器及其调理电路、串行接口的液晶显示器和冷媒分析仪、键盘、微型打印机、开关量输入输出控制、并口E2PROM等组成。(1)MSP430F149单片机M，SP430F149是全自动汽车冷媒加注系统的控制中心，完成传感器数据结果处理，开关量信号的检测，键盘的识别，USART0和USART1两个串口通信的管理,与CPLD器件的通信与控制。德州仪器(TI)公司的MSP430F149单片机是FLASH类型单片机，内置60KB+256字节FLASH，2KBRAM。冷媒加注系统采用液晶显示界面，程序中含有大量的界面和菜单、动画数据，MSP430F149中60KB的FLASHROM满足系统程序对存储空间的需求;2KB的内部RAM保证了数据采集、处理、显示等临时数据和大量的系统全局变量需求;丰富的I/O资源实现了键盘的扩充和开关量信号的输入检测，以及CPLD器件的通信和控制。(2)CPLD器件扩展单片机通过CPLD器件外接了存储器X28C512，8路固态继电器和微型打印机。其中X28C512为64K并口E2PROM，用来保存车辆加注信息数据库。8路固态继电器发出驱动输出信号，控制各个执行机构。CPLD器件选用ALTERA公司的EPF10K10A，解决了3V工作的单片机和5V工作器件的接口问题;EPF10K10A的端口驱动能力满足了固态继电器对驱动电流的要求;实现了单片机口线的扩展，精简了电路；EPF10K10A内部含有6144BitsRAM，可实现加注信息数据库的数据加密。(3)压力传感器及其调理电路冷媒加注系统采用应变式压力传感器实现电子秤功能。传感器检测平台上冷媒罐及其内部冷媒的重量，据此控制冷媒加注过程的进行，由下式表示：Q=(q1+q0)-(q2+q0)式中：Q已加注冷媒量，q0冷媒罐重量，q1加注前冷媒重量，q2当前冷媒重量。传感器输出毫伏级应变信号，经过放大、调零、滤波等调理后，送至模数转换芯片ICL7135进行A/D转换，输出的数字信号送单片机，完成压力信号的检测。单片机根据处理结果的值域范围，进行查表，实现分段线性化，将传感器信号同冷媒重量对应。冷媒加注系统实现的电子秤量程为0～50千克，精度为10克。(4)串口通信MSP430F149单片机有USART0和USART1两个串行通信口，冷媒加注系统外接了三个串口通信设备，串行接口的智能型LCD、冷媒分析仪和上位计算机。其中冷媒分析仪和上位机复用USART1通信口。RS232接口芯片选用了3V-5V兼容的MAX3232。(5)键盘和开关量检测利用MSP430F149的P1、P2口实现。P1、P2口具有中断功能，能够实时的捕捉触发事件。4软件系统设计全自动汽车冷媒加注控制系统软件包括监控程序、中断程序以及数据处理程序等。监控程序的主要作用是及时的响应用户的服务请求，有效地管理设备自身的软硬件及人机一体化联系设备，并在系统出故障时，提供相应的处理信息。主要有：系统初始化管理、键盘管理、显示管理、通信管理、仪器各个功能模块的管理、中断管理等。本系统用到的中断源有：串行口中断、外部中断、软件定时器中断。冷媒加注控制系统实现的功能主要有：自动加注、手动加注、电子秤计量、加注信息数据库管理、系统设置，如图4所示。(1)自动加注模式下冷媒加注系统自动地完成冷媒加注全过程；(2)手动加注模式下操作员可有选择的完成冷媒识别、回收、抽真空、加冷冻油、加注冷媒中的一项或多项操作；(3)电子秤功能可以检测称重平台上物体的质量；(4)数据管理功能实现对车辆加注信息数据库的维护，包括数据查询、数据浏览、记录的增加、修改和删除，另外，冷媒加注系统还提供了数据库更新功能，利用控制系统同上位机通信实现，在单片机控制下写入存储芯片X28C512；(5)系统设置功能包括设备信息设定、用户信息设定、冷媒信息设定、运行参数设定等。冷媒加注系统人机接口控制中，软件实现了各个液晶显示函数模块和输入法程序，能够进行数字、英文和汉字的输入，这些基本模块在人机接口操作中被调用。5结论本文研制的冷媒加注控制系统实现了汽车冷媒加注的全自动控制，提高了汽车制冷系统维护效率和维修质量，控制系统完成各项功能并达到各项精度指标，性能稳定，可靠性高，设备操作简单方便。
